% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lct-shrinkage.R
\name{LCT.shrinkage}
\alias{LCT.shrinkage}
\title{Linear Combination Test with Shrinkage Covariance Estimator}
\usage{
LCT.shrinkage(DATA, cl, nbPermutations = 1000, s0 = 0)
}
\arguments{
\item{DATA}{Expression data matrix with genes as rows and samples as columns.
Row names should be gene identifiers. Matrix should be numeric.}

\item{cl}{Phenotype vector defining group membership. Must be binary (two
levels). Can be numeric (0/1), factor, or character. Length must equal
number of columns in DATA.}

\item{nbPermutations}{Number of permutations for p-value calculation.
Default is 1000. Minimum recommended: 100. For more precise p-values near
significance threshold, use ≥10000. Rule of thumb: use ≥100/α where α is
your significance level.}

\item{s0}{Small positive constant added to eigenvalues for numerical
stability. Default is 0. Use small values (0.01-0.1) if eigenvalues are
very small or negative due to numerical precision issues.}
}
\value{
Numeric p-value between 0 and 1 representing the proportion of
permutations where the test statistic was as extreme or more extreme than
the observed value. Small p-values (e.g., < 0.05) suggest the gene set is
differentially expressed between groups.
}
\description{
Performs the Linear Combination Test using the Schäfer-Strimmer shrinkage
covariance estimator. This is the default and fastest method, recommended for
balanced study designs. The shrinkage estimator provides a well-conditioned
covariance matrix even when the number of genes exceeds the number of samples.
}
\details{
The Linear Combination Test tests whether any linear combination of genes in
the set is associated with the phenotype. The algorithm:
\enumerate{
\item Estimates the covariance matrix using shrinkage (corpcor::cov.shrink)
\item Performs eigenvalue decomposition
\item Transforms data to uncorrelated features
\item Calculates T²-like test statistic (sum of squared mean differences)
\item Permutes phenotype labels to generate null distribution
\item Computes p-value as proportion of permuted statistics ≥ observed
}

\strong{Performance}: ~0.5-1 second per gene set (with 1000 permutations)

\strong{When to use}: Default choice for most analyses, especially balanced designs.
}
\note{
Set \code{set.seed()} before calling this function to ensure reproducible
p-values across runs.
}
\examples{
# Example with simulated data
set.seed(123)
n_genes <- 50
n_samples <- 20

# Create expression data (genes x samples)
expression <- matrix(rnorm(n_genes * n_samples), nrow = n_genes)
rownames(expression) <- paste0("Gene", 1:n_genes)

# Add differential expression to first 10 genes in group 2
phenotype <- c(rep(0, 10), rep(1, 10))
expression[1:10, phenotype == 1] <- expression[1:10, phenotype == 1] + 2

# Run LCT with shrinkage estimator
p_value <- LCT.shrinkage(expression, phenotype, nbPermutations = 1000)
print(p_value)  # Should be small (< 0.05) due to differential expression

\donttest{
# Example with real gene set (subset of genes)
pathway_genes <- 1:20  # First 20 genes
subset_expression <- expression[pathway_genes, ]
p_pathway <- LCT.shrinkage(subset_expression, phenotype, nbPermutations = 5000)
}
}
\references{
Schäfer, J., & Strimmer, K. (2005). A shrinkage approach to large-scale
covariance matrix estimation and implications for functional genomics.
\emph{Statistical Applications in Genetics and Molecular Biology}, 4(1).
\doi{10.2202/1544-6115.1175}

Wang, X., Dinu, I., Liu, W., & Yasui, Y. (2011). Linear combination test
for hierarchical gene set analysis. \emph{Statistical Applications in
Genetics and Molecular Biology}, 10(1). \doi{10.2202/1544-6115.1618}
}
\seealso{
\code{\link{LCT.ridge}} for unbalanced designs,
\code{\link{LCT.glasso}} for sparse networks,
\code{\link{LCT.adaptive.lasso}} for feature selection,
\code{\link{perform_LCT}} for analyzing multiple gene sets
}
