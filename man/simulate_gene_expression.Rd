% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils-simulation.R
\name{simulate_gene_expression}
\alias{simulate_gene_expression}
\title{Simulate Gene Expression Data with Correlation Structure}
\usage{
simulate_gene_expression(rho, n_samples, n_genes, gamma, n_controls, n_cases)
}
\arguments{
\item{rho}{Correlation coefficient between genes. Must be between 0 and 1.
Values close to 0 indicate independent genes; values close to 1 indicate
highly correlated genes. Common values: 0.1 (weak), 0.5 (moderate), 0.9 (strong).}

\item{n_samples}{Total number of samples. Must equal n_controls + n_cases.}

\item{n_genes}{Number of genes to simulate. Typical range: 100-10000.}

\item{gamma}{Mean shift between groups. Added to case group mean. Represents
effect size for differential expression. Common values: 0 (no effect),
0.5 (small), 1.0 (medium), 2.0 (large).}

\item{n_controls}{Number of control samples (group 0).}

\item{n_cases}{Number of case samples (group 1).}
}
\value{
Matrix with n_genes rows and n_samples columns. Row names are random
gene identifiers (from \code{generate_gene_names}). Values are non-negative
expression levels (absolute values after simulation).
}
\description{
Generates synthetic gene expression data with specified correlation structure
and mean differences between control and case groups. Designed for power
analysis, method evaluation, and testing LCT performance under known conditions.
}
\details{
Data generation process:
\enumerate{
\item Generate control group: multivariate normal with mean 0, correlation rho
\item Generate case group: multivariate normal with mean 0+gamma, correlation rho
\item Combine groups and take absolute values (mimic log-scale expression)
\item Assign random gene names
}

The correlation structure is compound symmetric (all pairwise correlations = rho).
}
\note{
Set \code{set.seed()} before calling for reproducible data generation.
}
\examples{
# Simulate data with moderate correlation and medium effect
set.seed(42)
expression_data <- simulate_gene_expression(
  rho = 0.5,
  n_samples = 40,
  n_genes = 200,
  gamma = 1.0,
  n_controls = 20,
  n_cases = 20
)

# Check dimensions
dim(expression_data)  # Should be 200 x 40

# Verify mean difference
phenotype <- c(rep(0, 20), rep(1, 20))
mean_controls <- rowMeans(expression_data[, phenotype == 0])
mean_cases <- rowMeans(expression_data[, phenotype == 1])
mean(mean_cases - mean_controls)  # Should be approximately gamma

\donttest{
# Simulate null data (no differential expression)
null_data <- simulate_gene_expression(
  rho = 0.3,
  n_samples = 30,
  n_genes = 100,
  gamma = 0,  # No mean difference
  n_controls = 15,
  n_cases = 15
)

# Simulate strong effect with high correlation
strong_effect <- simulate_gene_expression(
  rho = 0.9,
  n_samples = 50,
  n_genes = 300,
  gamma = 2.0,  # Large effect
  n_controls = 25,
  n_cases = 25
)
}
}
\seealso{
\code{\link{run_LCT_simulation}} for running complete simulation studies,
\code{\link{generate_gene_names}} for gene identifier generation
}
