% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulation.R
\name{run_LCT_simulation}
\alias{run_LCT_simulation}
\title{Run LCT Simulation Study}
\usage{
run_LCT_simulation(
  n_samples,
  n_genes,
  rho,
  n_datasets,
  method,
  gene_sets,
  phenotype,
  gamma
)
}
\arguments{
\item{n_samples}{Sample size (total number of samples across both groups).}

\item{n_genes}{Number of genes to simulate in each dataset.}

\item{rho}{Correlation coefficient between genes (0-1).}

\item{n_datasets}{Number of simulation iterations to run.}

\item{method}{Covariance estimation method: "shrinkage", "ridge", "glasso",
or "adaptive_lasso".}

\item{gene_sets}{Predefined gene sets to test. Can be list or data frame
format (see \code{\link{perform_LCT}} for details).}

\item{phenotype}{Binary phenotype vector of length n_samples defining group
membership (0 = control, 1 = case).}

\item{gamma}{Mean difference parameter (effect size). Added to case group.}
}
\value{
List of length n_datasets, where each element is a data frame of
results from \code{\link{perform_LCT}} for that iteration. Each data frame
contains columns: GS_name, GS_size, p_value, q_value (if applicable), method.
}
\description{
Performs multiple iterations of LCT analysis on simulated data to evaluate
statistical power, Type I error control, and method performance under
controlled conditions. Useful for power analysis, sample size planning,
and method comparison.
}
\details{
For each iteration:
\enumerate{
\item Generate expression data using \code{\link{simulate_gene_expression}}
\item Apply LCT to predefined gene sets using \code{\link{perform_LCT}}
\item Store results
\item Handle errors gracefully (skip iteration if error occurs)
}

Progress is printed to console showing current iteration.

\strong{Typical use cases}:
\itemize{
\item Power analysis: Run with gamma > 0, calculate proportion of p < 0.05
\item Type I error: Run with gamma = 0, verify proportion of p < 0.05 ≈ 0.05
\item Method comparison: Run multiple methods, compare power and error rates
}
}
\note{
\itemize{
\item Set \code{set.seed()} before calling for reproducible results
\item Large n_datasets (>1000) may take considerable time
\item Failed iterations are skipped with a warning message
}
}
\examples{
# Small power analysis (few iterations for speed)
set.seed(999)

# Set up parameters
n_genes <- 1000
n_samples <- 30
phenotype <- c(rep(0, 15), rep(1, 15))

# Create gene set
gene_names <- generate_gene_names(n_genes)
gene_set <- list(TestSet = gene_names[1:50])

\donttest{
# Run simulation with medium effect
results <- run_LCT_simulation(
  n_samples = n_samples,
  n_genes = n_genes,
  rho = 0.3,
  n_datasets = 10,  # Use 100+ for real analysis
  method = "shrinkage",
  gene_sets = gene_set,
  phenotype = phenotype,
  gamma = 1.0
)

# Extract p-values
p_values <- sapply(results, function(x) x$p_value[1])

# Calculate power (proportion of significant results)
power <- mean(p_values < 0.05, na.rm = TRUE)
cat("Estimated power:", power, "\n")

# Type I error control simulation (gamma = 0)
null_results <- run_LCT_simulation(
  n_samples = n_samples,
  n_genes = n_genes,
  rho = 0.3,
  n_datasets = 10,
  method = "shrinkage",
  gene_sets = gene_set,
  phenotype = phenotype,
  gamma = 0  # No effect
)

null_p_values <- sapply(null_results, function(x) x$p_value[1])
type1_error <- mean(null_p_values < 0.05, na.rm = TRUE)
cat("Type I error rate:", type1_error, "\n")  # Should be ≈ 0.05
}
}
\seealso{
\code{\link{simulate_gene_expression}} for data generation,
\code{\link{perform_LCT}} for LCT analysis
}
