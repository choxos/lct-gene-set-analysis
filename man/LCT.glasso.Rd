% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lct-glasso.R
\name{LCT.glasso}
\alias{LCT.glasso}
\title{Linear Combination Test with Graphical Lasso Covariance Estimator}
\usage{
LCT.glasso(DATA, cl, nbPermutations = 1000, s0 = 0, rho = 0.4)
}
\arguments{
\item{DATA}{Expression data matrix with genes as rows and samples as columns.
Row names should be gene identifiers. Matrix should be numeric.}

\item{cl}{Phenotype vector defining group membership. Must be binary (two
levels). Can be numeric (0/1), factor, or character. Length must equal
number of columns in DATA.}

\item{nbPermutations}{Number of permutations for p-value calculation.
Default is 1000.}

\item{s0}{Small positive constant added to eigenvalues for numerical
stability. Default is 0.}

\item{rho}{Penalty parameter for graphical lasso. Default is 0.4. Higher
values induce more sparsity. Typical range: 0.1-1.0. For very sparse
networks, try rho > 0.5.}
}
\value{
Numeric p-value between 0 and 1 from the permutation test.
}
\description{
Performs the Linear Combination Test using the graphical lasso (GLASSO) for
sparse precision matrix estimation. Recommended when you want to identify
conditional independence structures in gene networks. GLASSO assumes most
genes are conditionally independent given others, resulting in a sparse
inverse covariance matrix.
}
\details{
The graphical lasso solves:
\deqn{\min_{\Theta} \{ -\log\det(\Theta) + \text{tr}(S\Theta) + \rho||\Theta||_1 \}}
where Θ is the precision matrix (inverse covariance), S is the sample
covariance, and ρ controls sparsity.

\strong{Advantages}:
\itemize{
\item Identifies direct gene-gene relationships (edges in network)
\item Removes spurious correlations due to indirect effects
\item Interpretable sparse network structure
}

\strong{Disadvantages}:
\itemize{
\item Slower than shrinkage or ridge (~4-8 sec per gene set)
\item Requires tuning rho parameter
\item May be overly sparse for highly connected networks
}

\strong{Performance}: ~4-8 seconds per gene set (with 1000 permutations) - slowest method

\strong{When to use}: Network analysis, sparse gene interactions, pathway analysis
}
\note{
GLASSO can be computationally intensive for large gene sets (>500 genes).
Consider using fewer permutations or smaller gene sets for faster computation.
}
\examples{
# Example with network structure
set.seed(789)
n_genes <- 30  # Smaller set for faster computation
n_samples <- 25

# Create expression data with network structure
# Genes 1-10 form a module, genes 11-20 form another module
expression <- matrix(rnorm(n_genes * n_samples), nrow = n_genes)
rownames(expression) <- paste0("Gene", 1:n_genes)

# Add modular structure
phenotype <- c(rep(0, 12), rep(1, 13))
expression[1:10, ] <- expression[1:10, ] + rnorm(10 * n_samples, 0, 0.5)
expression[1:10, phenotype == 1] <- expression[1:10, phenotype == 1] + 1.2

# Run LCT with GLASSO (captures sparse network)
p_value <- LCT.glasso(expression, phenotype, nbPermutations = 500, rho = 0.4)
print(p_value)

\donttest{
# Compare different rho values
p_sparse <- LCT.glasso(expression, phenotype, nbPermutations = 500, rho = 0.8)
p_dense <- LCT.glasso(expression, phenotype, nbPermutations = 500, rho = 0.2)

cat("Sparse (rho=0.8):", p_sparse, "\n")
cat("Dense (rho=0.2):", p_dense, "\n")
}
}
\references{
Friedman, J., Hastie, T., & Tibshirani, R. (2008). Sparse inverse covariance
estimation with the graphical lasso. \emph{Biostatistics}, 9(3), 432-441.
\doi{10.1093/biostatistics/kxm045}

Wang, X., Dinu, I., Liu, W., & Yasui, Y. (2011). Linear combination test
for hierarchical gene set analysis. \emph{Statistical Applications in
Genetics and Molecular Biology}, 10(1). \doi{10.2202/1544-6115.1618}
}
\seealso{
\code{\link{LCT.shrinkage}} for faster computation,
\code{\link{LCT.ridge}} for dense networks,
\code{\link{perform_LCT}} for multiple gene sets
}
